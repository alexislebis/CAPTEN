<link rel="import" href="../rdf-data-store/rdf-store-lister-element.html">
<link rel="import" href="../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">


<dom-module id="rte-lister-element">
    <template>
        <style>
        :host {
            font-family: sans-serif;
        }

        .content {
            @apply(--layout-vertical);
            height: 100%;
        }

        .pad {
            @apply(--layout-flex);
            @apply(--layout-vertical);
            padding: 0 16px;
        }

        .item {
            @apply(--layout-horizontal);
            cursor: pointer;
            padding: 16px 22px;
            border-bottom: 1px solid #DDD;
        }

        .item:focus,
        .item.selected:focus {
            outline: 0;
            background-color: #ddd;
        }

        .item.selected .star {
            color: var(--paper-blue-600);
        }

        .item .star {
            color: var(--paper-blue-600);
        }

        .star {
            width: 24px;
            height: 24px;
        }

        .removeElmt {
          color: var(--paper-red-600);
          width: 26px;
          height: 26px;
        }

        .removeElmt:hover {
          background-color: var(--paper-red-600);
          color: white;
        }

        iron-list {
            @apply(--layout-flex);
        }
        </style>

        <div>
        <h2>Custom Classes</h2>
        <!-- <ul id="rdfClasses"></ul> -->
        <iron-list id="ilCUSTCLS" items="[[customcls]]" as="item" class="flex" selection-enabled>
            <template>
                <div>
                    <div class$="[[_computeClass(selected)]]" on-tap="_custcTapped">
                        <div class="primary pad" tabindex$="[[tabIndex]]">[[item]]</div>
                        <div class="selectedItem">
                            <iron-icon icon$="[[iconForItem(selected)]]" class="star"></iron-icon>
                        </div>
                    </div>
                    <iron-icon class="removeElmt" icon="clear" on-tap="_removeCustomCLS"></iron-icon>
                    <div class="border"></div>
                </div>
            </template>
        </iron-list>
      </div>

        <div>
            <h2>Custom Properties</h2>
            <iron-list id="ilCUSTPROPS" items="[[customprops]]" as="item" class="flex" selection-enabled>
                <template>
                    <div>
                        <div class$="[[_computeClass(selected)]]" on-tap="_custpTapped">
                            <div class="primary pad" tabindex$="[[tabIndex]]">[[item]]</div>
                            <div class="selectedItem">
                                <iron-icon icon$="[[iconForItem(selected)]]" class="star"></iron-icon>
                            </div>
                        </div>
                        <iron-icon class="removeElmt" icon="clear" on-tap="_removeCustomProp"></iron-icon>
                        <div class="border"></div>

                </template>
                </div>
            </iron-list>
        </div>

        <rdf-store-lister-element id="lister" rdfclasses="{{rdfcls}}" rdfprops="{{rdfprops}}"></rdf-store-lister-element>

      </template>
      <script>
        Polymer(
        {
            is: 'rte-lister-element',

            properties:{
              store:
              {
                  type: Object,
                  value: function()
                  {
                      return {};
                  },
                  notify: true,
                  // observer: "_rdfStoreChanged",
              },
              graph:
              {
                  type: Object,
                  value: function()
                  {
                      return {};
                  },
                  // reflectToAttribute: true,
                  //observer: "_onGraphChanged",
                  notify: true,
              },
              graphuri: //@REMOVE
              {
                  type: Object,
                  value: function()
                  {
                      return {};
                  },
                  notify: true,
              },
              customcls:
              {
                type: Array,
                notify: true,
                value: function(){return[];},
              },
              customprops:
              {
                type: Array,
                notify: true,
                value: function(){return[];},
              },
              rdfcls:
              {
                  type: Array,
                  //value: function(){return {};},
                  notify: true,
              },
              rdfprops:
              {
                  type: Array,
                  notify: true,
              }
            },

            observers:[
              "_onCustomClsChanged(customcls.splices)",
              "_onCustomPropsChanged(customprops.splices)"
            ],

            // ready: function()
            // {
            //   if(this.customcls == undefined)
            //     this.customcls = [];
            //   if(this.customprops == undefined)
            //     this.customprops = [];
            //
            // },


            addCustomClass: function(cClass)
            {
              if (cClass == undefined && Object.keys(cClass).length === 0 && cClass.constructor === Object)
                  return;

              this.push('customcls', cClass);
            },
            addCustomProperty: function(cProp)
            {
              if (cProp == undefined && Object.keys(cProp).length === 0 && cProp.constructor === Object)
                return;

              this.push('customprops', cProp);
            },

            iconForItem: function(isSelected)
            {
                return isSelected ? 'check-circle' : 'radio-button-unchecked';
            },

            _computeClass: function(isSelected)
            {
                return isSelected ? 'item selected' : 'item';
            },

            _custcTapped: function(e)
            {
                console.log(e.model.item);
            },
            _custpTapped: function(e)
            {
                console.log(e.model.item);
            },

            _onCustomClsChanged: function(change)
            {

              if (Object.keys(this.customcls).length === 0 && this.customcls.constructor === Object)
                  return;

              if (!change)
                  return;

              console.log("loulCLS");
              console.log(this.customcls);
              Polymer.dom(this.root).querySelector('#ilCUSTCLS').notifyResize();
            },
            _onCustomPropsChanged: function(change)
            {
                if (Object.keys(this.customprops).length === 0 && this.customprops.constructor === Object)
                    return;

                if (!change)
                    return;

                Polymer.dom(this.root).querySelector('#ilCUSTPROPS').notifyResize();
            },
            _removeCustomCLS: function(e)
            {
              var index = this.customcls.indexOf(e.model.item);
              this.splice('customcls', index, 1);
              Polymer.dom(this.root).querySelector('#ilCUSTCLS').notifyResize();
            },
            _removeCustomProp: function(e)
            {
              var index = this.customprops.indexOf(e.model.item);
              this.splice('customprops', index, 1);
              Polymer.dom(this.root).querySelector('#ilCUSTPROPS').notifyResize();
            },
        });
      </script>
    </dom-module>
