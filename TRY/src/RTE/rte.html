<link rel="import" href="../wrapper/vis-element.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../RTE/rte-lister-element.html">
<link rel="import" href="../RTE/rgte-workzone-element.html">
<link rel="import" href="../rdf-data-store/rdf-store-nomenclature-element.html">
<link rel="import" href="../rdf-data-store/rdf-store-reader-element.html">
<link rel="import" href="../rdf-data-store/rdf-store-displayer-element.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../wrapper/ape-model-element.html">

<dom-module id="main-rte">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <ape-model-element></ape-model-element>
        <!-- <rgte-element id="rgte"></rgte-element> -->
        <!--<h1>RTE<span style="color:blue">#[[name]]</span></h1>-->
        <rdf-store-reader-element id="FRE" store="{{rdfStore}}" graph="{{graph}}" graphuri="{{graphuri}}"></rdf-store-reader-element>
        <rdf-store-nomenclature-element id="rdn" store="{{rdfStore}}" graph="{{graph}}" graphuri="{{graphuri}}" classes="{{rdfcls}}" props="{{rdfprops}}"></rdf-store-nomenclature-element>

        <rgte-workzone-element id="rgte-workzone" rdfstore="{{rdfStore}}" graph="{{graph}}" graphuri="{{graphuri}}" rdfcls="{{rdfcls}}" rdfprops="{{rdfprops}}"></rgte-workzone-element>

        <!-- <rte-lister-element id="rteList" store="{{rdfStore}}" graph="{{graph}}" graphuri="{{graphuri}}" rdfcls="{{rdfcls}}" rdfprops="{{rdfprops}}"></rte-lister-element> -->
        <rdf-store-displayer-element id="displayer" rdfclasses="{{rdfcls}}" rdfprops="{{rdfprops}}" store="{{rdfStore}}" graph="{{graph}}"></rdf-store-displayer-element>


        <paper-button raised on-tap="generateRDFGraphDisplay">Generate RDF Graph Display</paper-button>

        <paper-input label="Number of nodes" type="number" value="{{valNbNodes}}">
        </paper-input>
        <div id="ttest" on-tap="tapFunc">DisplayRDFGraphValue</div>
        <vis-element id="truc"></vis-element>
        <!-- <rdflib-element id="chouette"></rdflib-element> -->
    </template>
    <script>
        Polymer(
        {
            is: 'main-rte',
            properties:
            {
                name:
                {
                    type: String,
                    notify: true,
                    value: "455577781"
                },
                valNbNodes:
                {
                    type: Number,
                    value: 5,
                    notify: true,
                    observer: "updateNbNodes"
                },
                rdfStore:
                {
                    type: Object,
                    value: function()
                    {
                        return {};
                    },
                    notify: true,
                    // observer: "_rdfStoreChanged",
                },
                graph:
                {
                    type: Object,
                    value: function()
                    {
                        return {};
                    },
                    // reflectToAttribute: true,
                    observer: "_onGraphChanged",
                    notify: true,
                },
                graphuri: //@REMOVE
                {
                    type: Object,
                    value: function()
                    {
                        return {};
                    },
                    notify: true,
                },
                rdfcls:
                {
                    type: Array,
                    //value: function(){return {};},
                    notify: true,
                },
                rdfprops:
                {
                    type: Array,
                    notify: true,
                }
            },

            ready: function()
            {
                // this.$.FRE.returnFunction = function(){
                //   console.log("Wesh");
                // }
                //this.$.truc.addNode("lol","LOOOOOOOOOL");
            },
            tapFunc: function()
            {
                console.log(this.graph);
            },
            _rdfStoreChanged: function(e)
            {
                if (Object.keys(this.rdfStore).length === 0 && this.rdfStore.constructor === Object)
                    return;
                //this.$.rdsp.createClassesProperties();
                console.log("Oh");
            },
            updateNbNodes: function()
            {
                this.$.truc.setNodes(this.valNbNodes);
            },

            _onGraphChanged: function(n, o)
            {
                if (Object.keys(this.graph).length === 0 && this.graph.constructor === Object)
                    return;

                this.$.rdn.execute();
            },

            generateRDFGraphDisplay: function() {
              this.$.displayer.generateGraph();
            },
        });
    </script>
</dom-module>
