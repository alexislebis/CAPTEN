<link rel="import" href="../wrapper/rdflib-element.html">
<link rel="import" href="../../bower_components/file-reader/file-reader.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<dom-module id="rdf-data-store-reader-element">
  <template>
    <style>
      :host {
        display: block;
      }
      h2{
        text-align: center;
      }
    </style>

    <file-reader id="fileReaderElement"></file-reader>
    <h2>OR</h2>
    <paper-input label="Fetch data from the Web" disabled char-counter maxlength="2048"></paper-input>

  </template>
  <script>
    Polymer({
      is: 'rdf-data-store-reader-element',

      properties: {
        store: {
          value: function(){return {};},
          notify: true
       }
      },

      ready: function(){

        var that = this;
        this.$.fileReaderElement.returnFunction = function(){

          var body;
          var callback = {
                  onload: function(e){ that.loadDataStore(e.target.result);},
                  onprogress: function(){},
                  onerror: function(){}
                }

          this.getSlice(0,1,callback);

        };
      },

      loadDataStore: function(fileContent)
      {
        // console.log(fileContent);
        var uri = 'https://example.org/resource.ttl'
        // var body = '<a> <b> <c> .'
        var mimeType = 'application/rdf+xml'
        this.store = $rdf.graph()

        try {
            $rdf.parse(fileContent, this.store, uri, mimeType);
            console.log(this.store);
            console.log(this.store.index[0]);
            //console.log(store.statementsMatching("http://www.w3.org/2002/07/owl#ObjectProperty", "http://www.w3.org/1999/02/22-rdf-syntax-ns#type", undefined).length);
        } catch (err) {
            console.log(err)
        }
      },
    });
  </script>
</dom-module>
